# Drug–Symptom Modelling: SEIRS Virulence–Transmission Trade-off

A compartmental epidemic modelling framework that investigates how
symptom-targeting drugs affect the evolution of pathogen virulence.

## Background

The central hypothesis is that drugs designed to *mask symptoms* (without
clearing the pathogen) may inadvertently give highly virulent strains a
selective advantage.  Normally, high-virulence pathogens are constrained by
the fact that severely ill hosts reduce their contacts and therefore transmit
less.  A drug that restores normal behaviour while leaving the pathogen intact
could break this constraint.

The project implements a series of SEIRS (Susceptible → Exposed → Infectious
→ Recovered → Susceptible) models of increasing complexity:

| Version | Strains | Key addition |
|---------|---------|--------------|
| v1 | Two (high/low) | Baseline symptom-targeting drug |
| v2 | Two | Explicit contact rate · transmission probability; virulence-scaled detection |
| v3 | Two | Separate high/low contact rates; drug multipliers (m_c, m_r) |
| v4 | One | Single-strain drug sweep; three heatmap metrics |
| v5 | Two | Two-strain drug sweep; heatmap of dominant R0 |
| v6 | Two | phi_transmission sweep (virulence exploration) |
| v7 | Two | Drug restores contact rate (drug_contact_restore parameter) |

---

## Project Structure

```
Drug_symptom_modelling/
├── Models/
│   ├── SEIRS_Models.py        # ODE definitions for v1–v7
│   ├── params.py              # Shared default parameters
│   └── __init__.py
├── Scripts/
│   ├── Simple_SEIRS_model_singlestrain.py      # Minimal v4 single-strain demo
│   ├── Simple_SEIRS_model_twostrains.py        # Minimal v5 two-strain demo
│   ├── Drug_exploration_singlestrain.py        # v4 heatmap sweep
│   ├── Drug_exploration_singlestrain_vs_baseline.py  # v4 drug vs baseline
│   ├── Drug_exploration_twostrains_v5.py       # v5 heatmap sweep
│   ├── Drug_exploration_twostrains_v5_R0split.py     # v5 R0-split analysis
│   ├── Compare_SEIRS_v4_v5.py                  # Compare v4 and v5 behaviour
│   ├── Exploration_virulence.py                # v6 phi_transmission sweep
│   ├── Increase_virulence_c_contact.py         # Contact-rate virulence scenarios
│   ├── Drug_modifier_phi_sweep_3D.py           # 3-D landscape (mc × mr × phi)
│   ├── Tornado_sensitivity_v3.py               # v3 tornado sensitivity analysis
│   ├── Tornado_sensitivity_v7.py               # v7 tornado sensitivity analysis
│   ├── NGM.py                                  # Next Generation Matrix / R0
│   ├── Model_v1_exploration/
│   ├── Model_v2_exploration/
│   └── Model_v3_exploration/
├── Figures/                   # Saved plots (generated by scripts)
├── Tables/                    # Saved CSV summaries (generated by scripts)
├── requirements.txt
└── README.md
```

---

## Installation

```bash
# Clone the repository
git clone https://github.com/Sechyss/Drug_symptom_modelling.git
cd Drug_symptom_modelling

# Create and activate a virtual environment (recommended)
python -m venv venv
source venv/bin/activate        # Linux / macOS
# venv\Scripts\activate         # Windows

# Install dependencies
pip install -r requirements.txt
```

Quick check:

```bash
python - <<'PY'
import numpy, scipy, pandas, matplotlib, seaborn
print("All dependencies OK")
PY
```

> **Note:** All scripts are intended to be run from the **repository root**.

---

## Scripts Overview

### Minimal demos

#### `Scripts/Simple_SEIRS_model_singlestrain.py`
Runs the v4 single-strain model for a baseline (no drug) and a drug scenario,
prints summary metrics, and saves a comparison figure.

```bash
python Scripts/Simple_SEIRS_model_singlestrain.py
```

Output: `Figures/singlestrain_v4_drug_comparison.png`

#### `Scripts/Simple_SEIRS_model_twostrains.py`
Two-strain (high/low virulence) v5 demo producing a side-by-side comparison
figure.

```bash
python Scripts/Simple_SEIRS_model_twostrains.py
```

---

### Drug sweeps (heatmaps)

#### `Scripts/Drug_exploration_singlestrain.py` (Model v4)
Sweeps drug multipliers (m_c, m_r) over a grid and produces three heatmaps:
peak infected proportion, epidemic size, and effective R0.

```bash
python Scripts/Drug_exploration_singlestrain.py
```

Output: `Figures/Explore_v4_singlestrain_vs_baseline.png`

#### `Scripts/Drug_exploration_singlestrain_vs_baseline.py`
Compares the v4 single-strain drug scenario against the no-drug baseline
with a detailed four-panel figure.

```bash
python Scripts/Drug_exploration_singlestrain_vs_baseline.py
```

#### `Scripts/Drug_exploration_twostrains_v5.py` (Model v5)
Two-strain sweep producing three heatmaps (peak infections, epidemic size,
dominant R0 across both strains).

```bash
python Scripts/Drug_exploration_twostrains_v5.py
```

Output: `Figures/Explore_v5_twostrains.png`

#### `Scripts/Drug_exploration_twostrains_v5_R0split.py`
Same as above but splits the effective R0 heatmap by strain.

```bash
python Scripts/Drug_exploration_twostrains_v5_R0split.py
```

Output: `Figures/Explore_v5_twostrains_R0split.png`

#### `Scripts/Drug_modifier_phi_sweep_3D.py`
Three-dimensional parameter sweep over drug contact multiplier (m_c), drug
transmission multiplier (m_r), and virulence (phi_transmission), using
Model v7.  Produces 3-D surface landscapes faceted by phi_transmission.

```bash
python Scripts/Drug_modifier_phi_sweep_3D.py \
    --phi 1.0 1.2 1.5 1.8 2.2 \
    --mc 0.8 1.0 1.2 \
    --mr 0.5 0.7 1.0 \
    --days 365 --steps 365
```

Output: `Figures/drug_modifier_phi_sweep/peak_infection_landscape.png`

---

### Model comparison

#### `Scripts/Compare_SEIRS_v4_v5.py`
Runs both v4 and v5 under baseline and drug conditions, prints metrics, and
saves a combined comparison figure.

```bash
python Scripts/Compare_SEIRS_v4_v5.py
```

Output: `Figures/combined_v4_v5_comparison.png`

---

### Virulence exploration

#### `Scripts/Exploration_virulence.py`
Sweeps `phi_transmission` with Model v6 to show how increasing virulence
changes epidemic dynamics under different drug conditions.

```bash
python Scripts/Exploration_virulence.py
```

#### `Scripts/Increase_virulence_c_contact.py`
Explores the effect of increasing high-strain contact rate (c_high) on
epidemic outcomes, producing a multi-panel figure.

```bash
python Scripts/Increase_virulence_c_contact.py
```

Output: `Figures/increase_virulence_c_contact_extreme.png`

---

### Sensitivity analysis

#### `Scripts/Tornado_sensitivity_v3.py`
One-at-a-time sensitivity (tornado) plot for Model v3.  Each parameter is
perturbed ±20% and the resulting change in peak infections is ranked.

```bash
python Scripts/Tornado_sensitivity_v3.py
```

#### `Scripts/Tornado_sensitivity_v7.py`
Same analysis for Model v7, which includes the `drug_contact_restore`
parameter and dynamic high-strain contact rates.

```bash
python Scripts/Tornado_sensitivity_v7.py
```

Output: `Figures/Tornado_v7_peak_I.png`

---

### Next Generation Matrix

#### `Scripts/NGM.py`
Computes the Next Generation Matrix (NGM) and the basic reproduction number
R0 analytically for Model v2.

```bash
python Scripts/NGM.py
```

---

### Model v3 exploration (`Scripts/Model_v3_exploration/`)

| Script | Purpose |
|--------|---------|
| `Drug_exploration.py` | Baseline vs drug time series; single heatmap of peak λ |
| `Drug_three_drugs.py` | Baseline + three drug archetypes (Drug A/B/C) |
| `Drug_three_panels.py` | Three-panel subplot sweeping each drug type |

Drug A: contact↑, transmission↓ (m_c > 1, m_r < 1)  
Drug B: contact↑, transmission= (m_c > 1, m_r = 1)  
Drug C: contact=, transmission↓ (m_c = 1, m_r < 1)

```bash
# Baseline vs drug run
python Scripts/Model_v3_exploration/Drug_exploration.py run --days 200

# Grid sweep → heatmap of peak λ(t)
python Scripts/Model_v3_exploration/Drug_exploration.py sweep --days 200

# Three drug archetypes
python Scripts/Model_v3_exploration/Drug_three_drugs.py --days 200

# Three-panel sweep
python Scripts/Model_v3_exploration/Drug_three_panels.py --days 200 \
  --A-mc 1.0,1.2,1.4 --A-mr 0.6,0.8 \
  --B-mc 1.0,1.2,1.4 \
  --C-mr 0.6,0.8,1.0
```

---

## Model Parameters

Key parameters shared across model versions (see `Models/params.py`):

| Parameter | Default | Description |
|-----------|---------|-------------|
| `contact_rate` | 10.0 | Average contacts per person per day |
| `transmission_probability` | 0.025 | Probability of transmission per contact |
| `phi_transmission` | 1.5 | High-virulence transmission multiplier (β_h = φ · β_l) |
| `theta` | 0.3 | Fraction of detected cases that receive treatment |
| `sigma` | 1/5 | Recovery rate (1 / 5-day infectious period) |
| `tau` | 1/3 | Progression rate from exposed to infectious |
| `delta` | 1/120 | Immunity waning rate (120-day immunity) |
| `kappa_base` | 1.0 | Baseline detection rate |
| `kappa_scale` | 1.0 | Sensitivity of detection to virulence increase |
| `drug_contact_multiplier` | 1.20 | m_c: treated contacts relative to untreated |
| `drug_transmission_multiplier` | 0.75 | m_r: treated transmission per contact |
| `drug_contact_restore` | 0.8 | v7: degree to which drug restores high-strain contact rate |

---

## Figures

Generated figures are saved under `Figures/`.  A selection:

| File | Script | Description |
|------|--------|-------------|
| `Explore_v4_singlestrain_vs_baseline.png` | `Drug_exploration_singlestrain.py` | v4 heatmaps |
| `Explore_v5_twostrains.png` | `Drug_exploration_twostrains_v5.py` | v5 heatmaps |
| `Explore_v5_twostrains_R0split.png` | `Drug_exploration_twostrains_v5_R0split.py` | v5 R0 by strain |
| `combined_v4_v5_comparison.png` | `Compare_SEIRS_v4_v5.py` | v4 vs v5 side-by-side |
| `Tornado_v7_peak_I.png` | `Tornado_sensitivity_v7.py` | Sensitivity ranking |
| `increase_virulence_c_contact_extreme.png` | `Increase_virulence_c_contact.py` | Virulence scenarios |
| `drug_modifier_phi_sweep/` | `Drug_modifier_phi_sweep_3D.py` | 3-D landscapes |

---

## Contributing

1. Fork the repository and create a feature branch.
2. Install dependencies in a virtual environment (`pip install -r requirements.txt`).
3. Run the relevant scripts to verify your changes produce sensible figures.
4. Open a pull request with a clear description of the change and example output.
